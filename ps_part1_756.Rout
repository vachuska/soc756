
R version 4.1.2 (2021-11-01) -- "Bird Hippie"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## My key assumption is that everyone is born endowed with their lifetime educational attainment
> 
> ## I am also assuming that there is no mortality in the first five years of life
> 
> ## I am also assuming that everyone dies by age 50
> 
> setwd("/home/karl/Downloads/")
> 
> df <- read.csv("nLx_values.csv")
> 
> df$group <- substr(df$cat_race_ed_age,1,3)
> 
> df$race <- substr(df$cat_race_ed_age, 2,2)
> 
> df$age <- gsub(".*_", "", df$cat_race_ed_age)
> 
> bdf <- df[which(df$race=="b"),]
> 
> wdf <- df[which(df$race=="w"),]
> 
> w <- read.csv("whitemob.csv")
> w2 <- w[1:5,2:6]
> 
> b <- read.csv("blackmob.csv")
> b2 <- b[1:5,2:6]
> 
> wgrr <- c(1.76, 1.81, 1.62, 1.54, 1.27)/6
> bgrr <- c(2.18, 2.18, 1.67, 1.43, 1.01)/6
> 
> uniq <- unique(bdf$group)
> 
> uniqage <- as.numeric(unique(bdf$age))
> 
> blackmat_S <- list()
> for(i in 2:length(uniqage)) {
+   newmat <- matrix(0, nrow=5, ncol=5)
+   surv <- c()
+   for(j in 1:5) {
+     surv <- c(surv, bdf$nLx[which(bdf$age==uniqage[i] & bdf$group==uniq[j])]/bdf$nLx[which(bdf$age==uniqage[i]-5 & bdf$group==uniq[j])])
+   }
+   diag(newmat) <- surv
+   blackmat_S <- c(blackmat_S, list(newmat))
+   
+ }
> 
> print(blackmat_S)
[[1]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.7853404 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.8073957 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.8593395 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9180492 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9525782

[[2]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9391649 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9447025 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9583364 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9747703 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9847783

[[3]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9349684 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9407689 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9551037 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9724605 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9828701

[[4]]
          [,1]     [,2]      [,3]      [,4]      [,5]
[1,] 0.9177523 0.000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.924973 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.000000 0.9427996 0.0000000 0.0000000
[4,] 0.0000000 0.000000 0.0000000 0.9644074 0.0000000
[5,] 0.0000000 0.000000 0.0000000 0.0000000 0.9768863

[[5]]
          [,1]     [,2]      [,3]      [,4]      [,5]
[1,] 0.9032149 0.000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.911641 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.000000 0.9324538 0.0000000 0.0000000
[4,] 0.0000000 0.000000 0.0000000 0.9576574 0.0000000
[5,] 0.0000000 0.000000 0.0000000 0.0000000 0.9720382

[[6]]
          [,1]      [,2]      [,3]     [,4]      [,5]
[1,] 0.8914929 0.0000000 0.0000000 0.000000 0.0000000
[2,] 0.0000000 0.9008893 0.0000000 0.000000 0.0000000
[3,] 0.0000000 0.0000000 0.9241081 0.000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.952229 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.000000 0.9683606

[[7]]
         [,1]      [,2]     [,3]      [,4]      [,5]
[1,] 0.879774 0.0000000 0.000000 0.0000000 0.0000000
[2,] 0.000000 0.8901128 0.000000 0.0000000 0.0000000
[3,] 0.000000 0.0000000 0.915632 0.0000000 0.0000000
[4,] 0.000000 0.0000000 0.000000 0.9465277 0.0000000
[5,] 0.000000 0.0000000 0.000000 0.0000000 0.9644138

[[8]]
          [,1]      [,2]      [,3]     [,4]      [,5]
[1,] 0.8707797 0.0000000 0.0000000 0.000000 0.0000000
[2,] 0.0000000 0.8816698 0.0000000 0.000000 0.0000000
[3,] 0.0000000 0.0000000 0.9085646 0.000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.941099 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.000000 0.9600157

[[9]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.8633377 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.8744155 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.8997705 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9348137 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9540249

> 
> 
> blackmat_B <- list()
> for(i in 3:length(uniqage)) {
+   newmat <- matrix(0, nrow=5, ncol=5)
+   surv <- c()
+   for(j in 1:5) {
+     surv <- c(surv, 1-.5*(1-bdf$nLx[which(bdf$age==uniqage[i] & bdf$group==uniq[j])]/bdf$nLx[which(bdf$age==uniqage[i]-5 & bdf$group==uniq[j])]))
+   }
+   newmat <- (b2*bgrr)*surv/100
+   blackmat_B <- c(blackmat_B, list(newmat))
+   
+ }
> 
> 
> print(blackmat_B)
[[1]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.101809388 0.094411474 0.08560443 0.04438748 0.02571656
2 0.027909722 0.123650666 0.09821396 0.05793917 0.04557410
3 0.006813379 0.051781679 0.10519857 0.05777745 0.05123661
4 0.007765784 0.008942418 0.05718441 0.11672209 0.04447676
5 0.000000000 0.005345670 0.02722950 0.06197636 0.07250064

[[2]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.101589066 0.094207162 0.08541918 0.04429143 0.02566091
2 0.027853268 0.123400555 0.09801530 0.05782197 0.04548192
3 0.006802131 0.051696199 0.10502491 0.05768207 0.05115203
4 0.007756701 0.008931958 0.05711752 0.11658556 0.04442474
5 0.000000000 0.005340530 0.02720333 0.06191677 0.07243094

[[3]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.100685191 0.093368966 0.08465917 0.04389735 0.02543259
2 0.027626570 0.122396198 0.09721755 0.05735136 0.04511174
3 0.006759324 0.051370860 0.10436396 0.05731906 0.05083011
4 0.007725032 0.008895492 0.05688433 0.11610957 0.04424337
5 0.000000000 0.005324414 0.02712123 0.06172992 0.07221236

[[4]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.099921956 0.092661191 0.08401742 0.04356459 0.02523980
2 0.027435234 0.121548504 0.09654424 0.05695416 0.04479931
3 0.006723329 0.051097298 0.10380820 0.05701383 0.05055943
4 0.007698488 0.008864925 0.05668886 0.11571060 0.04409134
5 0.000000000 0.005311356 0.02705472 0.06157854 0.07203527

[[5]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.099306530 0.092090485 0.08349995 0.04329627 0.02508435
2 0.027280929 0.120864875 0.09600124 0.05663383 0.04454734
3 0.006694293 0.050876625 0.10335988 0.05676760 0.05034108
4 0.007677141 0.008840344 0.05653167 0.11538975 0.04396908
5 0.000000000 0.005301451 0.02700427 0.06146370 0.07190093

[[6]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.098691268 0.091519930 0.08298262 0.04302803 0.02492894
2 0.027126269 0.120179673 0.09545700 0.05631276 0.04429479
3 0.006664803 0.050652502 0.10290456 0.05651753 0.05011932
4 0.007654720 0.008814526 0.05636658 0.11505276 0.04384067
5 0.000000000 0.005290821 0.02695012 0.06134046 0.07175676

[[7]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.098219052 0.091082027 0.08258557 0.04282215 0.02480966
2 0.027005098 0.119642839 0.09503060 0.05606122 0.04409693
3 0.006640214 0.050465628 0.10252491 0.05630902 0.04993441
4 0.007633372 0.008789943 0.05620937 0.11473189 0.04371840
5 0.000000000 0.005278976 0.02688978 0.06120312 0.07159611

[[8]]
         X0.8     X9...11        X12     X13.15       X16.
1 0.097828337 0.090719704 0.08225704 0.04265180 0.02471096
2 0.026900986 0.119181584 0.09466423 0.05584509 0.04392693
3 0.006609618 0.050233100 0.10205251 0.05604956 0.04970433
4 0.007608655 0.008761481 0.05602737 0.11436039 0.04357684
5 0.000000000 0.005262840 0.02680759 0.06101605 0.07137727

> 
> uniq <- unique(wdf$group)
> 
> whitemat_S <- list()
> for(i in 2:length(uniqage)) {
+   newmat <- matrix(0, nrow=5, ncol=5)
+   surv <- c()
+   for(j in 1:5) {
+     surv <- c(surv, wdf$nLx[which(wdf$age==uniqage[i] & wdf$group==uniq[j])]/wdf$nLx[which(wdf$age==uniqage[i]-5 & wdf$group==uniq[j])])
+   }
+   diag(newmat) <- surv
+   whitemat_S <- c(whitemat_S, list(newmat))
+   
+ }
> 
> print(whitemat_S)
[[1]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.8732587 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9081841 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9438551 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9735895 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9793494

[[2]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9621369 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9719353 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9822836 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9908748 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9926301

[[3]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9591028 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9694551 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9804342 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9894877 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9914113

[[4]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9477788 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9606659 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9743162 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9854872 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9879864

[[5]]
          [,1]      [,2]      [,3]     [,4]      [,5]
[1,] 0.9382676 0.0000000 0.0000000 0.000000 0.0000000
[2,] 0.0000000 0.9532976 0.0000000 0.000000 0.0000000
[3,] 0.0000000 0.0000000 0.9692145 0.000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.982144 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.000000 0.9850998

[[6]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9305929 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9473622 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9651278 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9794337 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9827186

[[7]]
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.9227596 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.0000000 0.9411862 0.0000000 0.0000000 0.0000000
[3,] 0.0000000 0.0000000 0.9606946 0.0000000 0.0000000
[4,] 0.0000000 0.0000000 0.0000000 0.9762333 0.0000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.9798101

[[8]]
          [,1]      [,2]      [,3]      [,4]     [,5]
[1,] 0.9160674 0.0000000 0.0000000 0.0000000 0.000000
[2,] 0.0000000 0.9354675 0.0000000 0.0000000 0.000000
[3,] 0.0000000 0.0000000 0.9560095 0.0000000 0.000000
[4,] 0.0000000 0.0000000 0.0000000 0.9720924 0.000000
[5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.975845

[[9]]
         [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.909382 0.0000000 0.0000000 0.0000000 0.0000000
[2,] 0.000000 0.9291009 0.0000000 0.0000000 0.0000000
[3,] 0.000000 0.0000000 0.9499621 0.0000000 0.0000000
[4,] 0.000000 0.0000000 0.0000000 0.9659698 0.0000000
[5,] 0.000000 0.0000000 0.0000000 0.0000000 0.9697942

> 
> whitemat_B <- list()
> for(i in 3:length(uniqage)) {
+   newmat <- matrix(0, nrow=5, ncol=5)
+   surv <- c()
+   for(j in 1:5) {
+     surv <- c(surv, 1-.5*(1-wdf$nLx[which(wdf$age==uniqage[i] & wdf$group==uniq[j])]/wdf$nLx[which(wdf$age==uniqage[i]-5 & wdf$group==uniq[j])]))
+   }
+   newmat <- (w2*wgrr)*surv/100
+   whitemat_B <- c(whitemat_B, list(newmat))
+   
+ }
> 
> 
> print(whitemat_B)
[[1]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0379869703 0.051512634 0.13957334 0.03741141 0.02158351
2 0.0101127413 0.044615035 0.12700413 0.06186618 0.05353804
3 0.0037465160 0.016324105 0.12229699 0.06690207 0.05807100
4 0.0025549559 0.006898381 0.06208543 0.08635751 0.09734382
5 0.0002108867 0.006959261 0.03015680 0.05461965 0.11894009

[[2]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0379282294 0.051432978 0.13935751 0.03735356 0.02155013
2 0.0101000223 0.044558922 0.12684440 0.06178837 0.05347071
3 0.0037430206 0.016308875 0.12218289 0.06683965 0.05801682
4 0.0025531759 0.006893575 0.06204217 0.08629735 0.09727600
5 0.0002107577 0.006955004 0.03013835 0.05458624 0.11886734

[[3]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0377089974 0.051135686 0.13855200 0.03713765 0.02142557
2 0.0100549483 0.044360066 0.12627832 0.06151263 0.05323208
3 0.0037314576 0.016258494 0.12180544 0.06663317 0.05783759
4 0.0025480419 0.006879713 0.06191742 0.08612382 0.09708040
5 0.0002103952 0.006943043 0.03008652 0.05449237 0.11866291

[[4]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0375248606 0.050885985 0.13787543 0.03695630 0.02132094
2 0.0100171612 0.044193358 0.12580376 0.06128146 0.05303203
3 0.0037218153 0.016216481 0.12149069 0.06646099 0.05768814
4 0.0025437514 0.006868129 0.06181316 0.08597880 0.09691693
5 0.0002100897 0.006932961 0.03004283 0.05441324 0.11849061

[[5]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0373762790 0.050684499 0.13732951 0.03680997 0.02123652
2 0.0099867227 0.044059071 0.12542149 0.06109524 0.05287088
3 0.0037140915 0.016182827 0.12123856 0.06632306 0.05756842
4 0.0025402732 0.006858738 0.06172864 0.08586123 0.09678441
5 0.0002098377 0.006924645 0.03000679 0.05434797 0.11834847

[[6]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0372246259 0.050478849 0.13677230 0.03666062 0.02115036
2 0.0099550498 0.043919337 0.12502371 0.06090148 0.05270320
3 0.0037057127 0.016146320 0.12096505 0.06617344 0.05743855
4 0.0025361660 0.006847648 0.06162883 0.08572241 0.09662792
5 0.0002095299 0.006914487 0.02996278 0.05426825 0.11817487

[[7]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0370950654 0.050303157 0.13629626 0.03653302 0.02107674
2 0.0099257224 0.043789952 0.12465540 0.06072207 0.05254794
3 0.0036968579 0.016107738 0.12067600 0.06601532 0.05730130
4 0.0025308519 0.006833300 0.06149970 0.08554279 0.09642546
5 0.0002091103 0.006900639 0.02990277 0.05415956 0.11793819

[[8]]
          X0.8     X9...11        X12     X13.15       X16.
1 0.0369656359 0.050127643 0.13582071 0.03640555 0.02100320
2 0.0098930726 0.043645909 0.12424535 0.06052233 0.05237509
3 0.0036854283 0.016057938 0.12030291 0.06581122 0.05712414
4 0.0025229945 0.006812085 0.06130877 0.08527722 0.09612609
5 0.0002084699 0.006879506 0.02981119 0.05399370 0.11757702

> 
> proc.time()
   user  system elapsed 
  0.195   0.029   0.195 
